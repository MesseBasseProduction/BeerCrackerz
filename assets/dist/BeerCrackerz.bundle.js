!function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};e.d(t,{default:function(){return d}});var r=Object.freeze({blue:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-blue.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),gold:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-gold.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),red:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-red.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),green:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-green.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),orange:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-orange.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),yellow:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-yellow.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),violet:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-violet.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),grey:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-grey.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),black:new window.L.Icon({iconUrl:"assets/img/marker/marker-icon-black.png",shadowUrl:"assets/img/marker/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),user:new window.L.Icon({iconUrl:"assets/img/marker/user-position.png",shadowUrl:"assets/img/marker/user-position-shadow.png",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[1,-34],shadowSize:[32,32]})});function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._container=null,this._items=[],this._currentRate=0,this._clicked=-1,this._init(t),this._events()}var t,r;return t=e,(r=[{key:"_init",value:function(e){this._container=e;for(var t=0;t<e.children.length;++t)this._items.push(e.children[t])}},{key:"_events",value:function(){this._container.addEventListener("mouseover",this._containerHovered.bind(this),!1),this._container.addEventListener("mouseout",this._pointerExit.bind(this),!1);for(var e=0;e<this._items.length;++e)this._items[e].addEventListener("click",this._starClicked.bind(this),!1)}},{key:"_containerHovered",value:function(e){"IMG"===e.target.tagName&&(this._currentRate=parseInt(e.target.dataset.id),this._container.dataset.rate=this._currentRate,this.updateStars())}},{key:"_pointerExit",value:function(){this._currentRate=-1===this._clicked?0:this._clicked,this._container.dataset.rate=this._currentRate,this.updateStars()}},{key:"_starClicked",value:function(e){this._currentRate=parseInt(e.target.dataset.id),this._container.dataset.rate=this._currentRate,this._clicked=this._currentRate,this.updateStars()}},{key:"updateStars",value:function(){for(var e=0;e<this._items.length;++e)e<=this._currentRate?(this._items[e].classList.add("active"),e<=this._clicked&&this._items[e].classList.add("selected")):(this._items[e].classList.remove("active"),this._items[e].classList.remove("selected"))}},{key:"currentRate",get:function(){return this._currentRate}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"fetchTemplate",value:function(e){return new Promise((function(t,r){fetch(e).then((function(e){e.text().then((function(e){t(document.createRange().createContextualFragment(e))})).catch(r)})).catch(r)}))}},{key:"stripDom",value:function(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""}},{key:"getDistanceBetweenCoords",value:function(e,t){var r=e[1]*Math.PI/180,n=e[0]*Math.PI/180,a=t[1]*Math.PI/180,i=t[0]*Math.PI/180,o=i-n,c=a-r,s=Math.pow(Math.sin(o/2),2)+Math.cos(n)*Math.cos(i)*Math.pow(Math.sin(c/2),2);return 2*Math.asin(Math.sqrt(s))*6371*1e3}},{key:"getPreference",value:function(e){return localStorage.getItem(e)||null}},{key:"setPreference",value:function(e,t){localStorage.setItem(e,t)}},{key:"USER_COLOR",get:function(){return"#63fff5"}},{key:"SPOT_COLOR",get:function(){return"#26ad23"}},{key:"STORE_COLOR",get:function(){return"#247dc9"}},{key:"BAR_COLOR",get:function(){return"#ca2a3d"}},{key:"CIRCLE_RADIUS",get:function(){return 100}},{key:"NEW_MARKER_RANGE",get:function(){return 200}},{key:"MAP_BOUNDS",get:function(){return window.L.latLngBounds(window.L.latLng(-89.98155760646617,-180),window.L.latLng(89.99346179538875,180))}},{key:"HIGH_ACCURACY",get:function(){return{enableHighAccuracy:!0,maximumAge:1e3,timeout:900}}},{key:"OPTIMIZED_ACCURACY",get:function(){return{enableHighAccuracy:!1,maximumAge:3e4,timeout:29e3}}}],null&&i(t.prototype,null),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"placeMarker",value:function(e){var t=r.black;"store"===e.type?t=r.blue:"spot"===e.type?t=r.green:"bar"===e.type?t=r.red:"user"===e.type&&(t=r.user);var n=window.L.marker([e.lat,e.lng],{icon:t}).addTo(window.BeerCrackerz.map).on("click",(function(){window.BeerCrackerz.map.flyTo([e.lat,e.lng],18)}));return e.name&&n.bindPopup(e.name),n}},{key:"drawUserMarker",value:function(t){t.marker?(t.marker.setLatLng(t),t.circle.setLatLng(t)):(t.type="user",t.marker=e.placeMarker(t),t.radius=t.accuracy,t.circle=e.drawCircle(t),"true"===o.getPreference("poi-show-circle")&&t.circle.setStyle({opacity:1,fillOpacity:.1}),t.marker.on("click",window.BeerCrackerz.mapClicked.bind(window.BeerCrackerz)))}},{key:"definePOI",value:function(t,r){var n=document.createElement("DIV"),a=document.createElement("BUTTON"),i=document.createElement("BUTTON"),o=document.createElement("BUTTON");a.innerHTML="Ajouter un spot",i.innerHTML="Ajouter un magasin",o.innerHTML="Ajouter un bar",n.className="new-poi",n.appendChild(a),n.appendChild(i),n.appendChild(o),t.name=n;var c=e.placeMarker(t).openPopup();return t.marker=c,t.addedCallback=r,a.addEventListener("click",(function(){c.isBeingDefined=!0,c.closePopup(),e.defineNewSpot(t)})),i.addEventListener("click",(function(){c.isBeingDefined=!0,c.closePopup(),e.defineNewStore(t)})),o.addEventListener("click",(function(){c.isBeingDefined=!0,c.closePopup(),e.defineNewBar(t)})),c.on("popupclose",(function(){c.isBeingDefined||(c.popupClosed=!0,c.removeFrom(window.BeerCrackerz.map))})),c}},{key:"defineNewSpot",value:function(t){o.fetchTemplate("assets/html/newspot.html").then((function(r){var n=r.querySelector("#spot-name"),i=r.querySelector("#spot-desc"),o=r.querySelector("#submit-spot"),c=r.querySelector("#cancel-spot"),s=r.querySelector("#close-aside"),l=new a(r.querySelector("#star-rating")),d=function(){t.marker.isBeingDefined=!1,t.marker.removeFrom(window.BeerCrackerz.map),document.getElementById("aside").style.opacity=0,setTimeout((function(){return document.getElementById("aside").innerHTML=""}),200)};o.addEventListener("click",(function(){d(),e.buildSpotUI(n.value,t).then((function(r){t.type="spot",t.name=r,t.description=i.value,t.rate=l.currentRate,t.marker.removeFrom(window.BeerCrackerz.map),t.marker=e.placeMarker(t),t.addedCallback(t)}))})),c.addEventListener("click",d),s.addEventListener("click",d),document.getElementById("aside").innerHTML="",document.getElementById("aside").appendChild(r),document.getElementById("aside").style.opacity=1}))}},{key:"defineNewStore",value:function(t){o.fetchTemplate("assets/html/newstore.html").then((function(r){var n=r.querySelector("#store-name"),i=r.querySelector("#submit-store"),o=r.querySelector("#cancel-store"),c=r.querySelector("#close-aside"),s=new a(r.querySelector("#price-rating")),l=function(){t.marker.isBeingDefined=!1,t.marker.removeFrom(window.BeerCrackerz.map),document.getElementById("aside").style.opacity=0,setTimeout((function(){return document.getElementById("aside").innerHTML=""}),200)};i.addEventListener("click",(function(){l(),e.buildStoreUI(n.value,t).then((function(r){t.type="store",t.name=r,t.price=s.currentRate,t.marker.removeFrom(window.BeerCrackerz.map),t.marker=e.placeMarker(t),t.addedCallback(t)}))})),o.addEventListener("click",l),c.addEventListener("click",l),document.getElementById("aside").innerHTML="",document.getElementById("aside").appendChild(r),document.getElementById("aside").style.opacity=1}))}},{key:"defineNewBar",value:function(t){o.fetchTemplate("assets/html/newbar.html").then((function(r){var n=r.querySelector("#bar-name"),i=r.querySelector("#submit-bar"),o=r.querySelector("#cancel-bar"),c=r.querySelector("#close-aside"),s=new a(r.querySelector("#price-rating")),l=function(){t.marker.isBeingDefined=!1,t.marker.removeFrom(window.BeerCrackerz.map),document.getElementById("aside").style.opacity=0,setTimeout((function(){return document.getElementById("aside").innerHTML=""}),200)};i.addEventListener("click",(function(){l(),e.buildBarUI(n.value,t).then((function(r){t.type="bar",t.name=r,t.price=s.currentRate,t.marker.removeFrom(window.BeerCrackerz.map),t.marker=e.placeMarker(t),t.addedCallback(t)}))})),o.addEventListener("click",l),c.addEventListener("click",l),document.getElementById("aside").innerHTML="",document.getElementById("aside").appendChild(r),document.getElementById("aside").style.opacity=1}))}},{key:"buildSpotUI",value:function(t,r){return new Promise((function(n){o.fetchTemplate("assets/html/spot.html").then((function(a){var i=document.createElement("DIV");i.appendChild(a),i.innerHTML=i.innerHTML.replace("{{SPOT_NAME}}",o.stripDom(t)),i.innerHTML=i.innerHTML.replace("{{SPOT_LAT}}",r.lat),i.innerHTML=i.innerHTML.replace("{{SPOT_LNG}}",r.lng),r.color=o.SPOT_COLOR,r.circle=e.drawCircle(r),r.tooltip=window.L.tooltip({permanent:!0,direction:"center",className:"marker-tooltip",interactive:!0}).setContent(t).setLatLng(r.circle.getLatLng()),"true"===o.getPreference("poi-marker-label")&&r.tooltip.addTo(window.BeerCrackerz.map),n(i)}))}))}},{key:"buildStoreUI",value:function(t,r){return new Promise((function(n){o.fetchTemplate("assets/html/store.html").then((function(a){var i=document.createElement("DIV");i.appendChild(a),i.innerHTML=i.innerHTML.replace("{{STORE_NAME}}",o.stripDom(t)),i.innerHTML=i.innerHTML.replace("{{STORE_LAT}}",r.lat),i.innerHTML=i.innerHTML.replace("{{STORE_LNG}}",r.lng),r.color=o.STORE_COLOR,r.circle=e.drawCircle(r),r.tooltip=window.L.tooltip({permanent:!0,direction:"center",className:"marker-tooltip",interactive:!0}).setContent(t).setLatLng(r.circle.getLatLng()),"true"===o.getPreference("poi-marker-label")&&r.tooltip.addTo(window.BeerCrackerz.map),n(i)}))}))}},{key:"buildBarUI",value:function(t,r){return new Promise((function(n){o.fetchTemplate("assets/html/bar.html").then((function(a){var i=document.createElement("DIV");i.appendChild(a),i.innerHTML=i.innerHTML.replace("{{BAR_NAME}}",o.stripDom(t)),i.innerHTML=i.innerHTML.replace("{{BAR_LAT}}",r.lat),i.innerHTML=i.innerHTML.replace("{{BAR_LNG}}",r.lng),r.color=o.BAR_COLOR,r.circle=e.drawCircle(r),r.tooltip=window.L.tooltip({permanent:!0,direction:"center",className:"marker-tooltip",interactive:!0}).setContent(t).setLatLng(r.circle.getLatLng()),"true"===o.getPreference("poi-marker-label")&&r.tooltip.addTo(window.BeerCrackerz.map),n(i)}))}))}},{key:"drawCircle",value:function(e){return window.L.circle(e,{color:e.color,fillColor:e.color,opacity:0,fillOpacity:0,radius:e.radius?e.radius:o.CIRCLE_RADIUS}).addTo(window.BeerCrackerz.map)}},{key:"setMarkerCircles",value:function(e,t){for(var r=0;r<e.length;++r)t?e[r].circle.addTo(window.BeerCrackerz.map):e[r].circle.removeFrom(window.BeerCrackerz.map)}},{key:"setMarkerLabels",value:function(e,t){for(var r=0;r<e.length;++r)t?e[r].tooltip.addTo(window.BeerCrackerz.map):e[r].tooltip.removeFrom(window.BeerCrackerz.map)}}],null&&c(t.prototype,null),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._map=null,this._user={lat:48.853121540141096,lng:2.3498955769881156,accuracy:0,marker:null,circle:null,color:o.USER_COLOR},this._newMarker=null,this._marks={spot:[],store:[],bar:[]},this._watchId=null,this._isZooming=!1,this._initDebug().then(this._initPreferences.bind(this)).then(this._initGeolocation.bind(this)).then(this._initMap.bind(this)).then(this._initEvents.bind(this))}var t,r;return t=e,(r=[{key:"_initDebug",value:function(){return new Promise((function(e){if(!0===window.DEBUG){var t=document.createElement("DIV"),r=document.createElement("P"),n=document.createElement("P"),a=document.createElement("P"),i=document.createElement("P");t.classList.add("debug-container"),r.classList.add("debug-updates-amount"),a.classList.add("debug-user-lat"),i.classList.add("debug-user-lng"),n.classList.add("debug-user-accuracy"),r.innerHTML="<b>Updates</b> : 0",t.appendChild(r),t.appendChild(n),t.appendChild(a),t.appendChild(i),document.body.appendChild(t)}e()}))}},{key:"_initPreferences",value:function(){return new Promise((function(e){null===o.getPreference("poi-show-spot")&&o.setPreference("poi-show-spot",!0),null===o.getPreference("poi-show-store")&&o.setPreference("poi-show-store",!0),null===o.getPreference("poi-show-bar")&&o.setPreference("poi-show-bar",!0),e()}))}},{key:"_initGeolocation",value:function(){var e=this;return new Promise((function(t){"geolocation"in navigator?e._watchId=navigator.geolocation.watchPosition((function(r){if(e._user.lat=r.coords.latitude,e._user.lng=r.coords.longitude,e._user.accuracy=r.coords.accuracy,e._map&&(s.drawUserMarker(e._user),e.updateMarkerCirclesVisibility(),"true"!==o.getPreference("lock-center-on")||e._isZooming||e._map.setView(e._user)),!0===window.DEBUG){var n=parseInt(document.querySelector(".debug-updates-amount").innerHTML.split(" : ")[1])+1;document.querySelector(".debug-updates-amount").innerHTML="<b>Updates</b> : ".concat(n),document.querySelector(".debug-user-accuracy").innerHTML="<b>Accuracy</b> : ".concat(e._user.accuracy,"m"),document.querySelector(".debug-user-lat").innerHTML="<b>Lat</b> : ".concat(e._user.lat),document.querySelector(".debug-user-lng").innerHTML="<b>Lng</b> : ".concat(e._user.lng)}t()}),t,{enableHighAccuracy:!0,maximumAge:3e4,timeout:29e3}):(console.error("Your browser doesn't implement the geolocation API. BeerCrackerz is unusable."),t())}))}},{key:"_initMap",value:function(){var e=this;return new Promise((function(t){e._map=window.L.map("beer-crakerz-map",{zoomControl:!1}).setView([e._user.lat,e._user.lng],18),window.L.control.scale().addTo(e._map),e._map.on("click",e.mapClicked.bind(e)),s.drawUserMarker(e._user);var r=window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',minZoom:2}).addTo(e._map),n=window.L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'&copy; <a href="https://www.arcgis.com/home/item.html?id=10df2279f9684e4a9f6a7f08febac2a9">Esri</a>',minZoom:2});e._map.setMaxBounds(o.MAP_BOUNDS);var a={"<p>Plan</p>":r,"<p>Satellite</p>":n};window.L.control.layers(a,{},{position:"bottomright"}).addTo(e._map),t()}))}},{key:"_initEvents",value:function(){var e=this;return new Promise((function(t){document.getElementById("user-profile").addEventListener("click",e.userProfileModal.bind(e)),document.getElementById("about").addEventListener("click",e.aboutModal.bind(e)),document.getElementById("hide-show").addEventListener("click",e.hidShowModal.bind(e)),document.getElementById("center-on").addEventListener("click",e.toggleFocusLock.bind(e)),document.getElementById("overlay").addEventListener("click",e.closeModal.bind(e)),e._map.on("drag",(function(){e._map.panInsideBounds(o.MAP_BOUNDS,{animate:!0}),"true"===o.getPreference("lock-center-on")&&e.toggleFocusLock()})),"true"===o.getPreference("lock-center-on")&&document.getElementById("center-on").classList.add("lock-center-on"),window.BeerCrackerz.map.on("zoomstart",(function(){e._isZooming=!0,s.setMarkerCircles(e._marks.spot,!1),s.setMarkerCircles(e._marks.store,!1),s.setMarkerCircles(e._marks.bar,!1),s.setMarkerCircles([e._user],!1)})),window.BeerCrackerz.map.on("zoomend",(function(){e._isZooming=!1,s.setMarkerCircles(e._marks.spot,!0),s.setMarkerCircles(e._marks.store,!0),s.setMarkerCircles(e._marks.bar,!0),s.setMarkerCircles([e._user],!0)})),t()}))}},{key:"toggleFocusLock",value:function(){"true"===o.getPreference("lock-center-on")?(document.getElementById("center-on").classList.remove("lock-center-on"),o.setPreference("lock-center-on","false")):(document.getElementById("center-on").classList.add("lock-center-on"),this._map.flyTo([this._user.lat,this._user.lng],18),o.setPreference("lock-center-on","true"))}},{key:"toggleLabel",value:function(){var e=!("true"===o.getPreference("poi-marker-label"));s.setMarkerLabels(this._marks.spot,e),s.setMarkerLabels(this._marks.store,e),s.setMarkerLabels(this._marks.bar,e),o.setPreference("poi-marker-label",e)}},{key:"toggleCircle",value:function(){var e=!("true"===o.getPreference("poi-show-circle"));s.setMarkerCircles(this._marks.spot,e),s.setMarkerCircles(this._marks.store,e),s.setMarkerCircles(this._marks.bar,e),s.setMarkerCircles([this._user],e),o.setPreference("poi-show-circle",e),this.updateMarkerCirclesVisibility()}},{key:"toggleMarkers",value:function(e){for(var t=!("true"===o.getPreference("poi-show-".concat(e))),r=0;r<this._marks[e].length;++r)!0===t?this._marks[e][r].marker.addTo(this._map):this._marks[e][r].marker.removeFrom(this._map);o.setPreference("poi-show-".concat(e),t)}},{key:"userProfileModal",value:function(){o.fetchTemplate("assets/html/user.html").then((function(e){document.getElementById("overlay").appendChild(e),document.getElementById("overlay").style.display="flex",setTimeout((function(){return document.getElementById("overlay").style.opacity=1}),50)}))}},{key:"aboutModal",value:function(){o.fetchTemplate("assets/html/about.html").then((function(e){document.getElementById("overlay").appendChild(e),document.getElementById("overlay").style.display="flex",setTimeout((function(){return document.getElementById("overlay").style.opacity=1}),50)}))}},{key:"hidShowModal",value:function(){var e=this;o.fetchTemplate("assets/html/hideshow.html").then((function(t){document.getElementById("overlay").appendChild(t),document.getElementById("overlay").style.display="flex","true"===o.getPreference("poi-marker-label")&&(document.getElementById("label-toggle").checked=!0),"true"===o.getPreference("poi-show-circle")&&(document.getElementById("circle-toggle").checked=!0),"true"===o.getPreference("poi-show-spot")&&(document.getElementById("show-spots").checked=!0),"true"===o.getPreference("poi-show-store")&&(document.getElementById("show-stores").checked=!0),"true"===o.getPreference("poi-show-bar")&&(document.getElementById("show-bars").checked=!0),document.getElementById("modal-close").addEventListener("click",e.closeModal.bind(e)),document.getElementById("modal-close-button").addEventListener("click",e.closeModal.bind(e)),document.getElementById("label-toggle").addEventListener("change",e.toggleLabel.bind(e)),document.getElementById("circle-toggle").addEventListener("change",e.toggleCircle.bind(e)),document.getElementById("show-spots").addEventListener("change",e.toggleMarkers.bind(e,"spot")),document.getElementById("show-stores").addEventListener("change",e.toggleMarkers.bind(e,"store")),document.getElementById("show-bars").addEventListener("change",e.toggleMarkers.bind(e,"bar")),setTimeout((function(){return document.getElementById("overlay").style.opacity=1}),50)}))}},{key:"closeModal",value:function(e){"overlay"!==e.target.id&&-1===e.target.id.indexOf("close")||(document.getElementById("overlay").style.opacity=0,setTimeout((function(){document.getElementById("overlay").style.display="none",document.getElementById("overlay").innerHTML=""}),300))}},{key:"mapClicked",value:function(e){this._newMarker&&this._newMarker.popupClosed?this._newMarker=null:null!==this._newMarker&&this._newMarker.isBeingDefined||(o.getDistanceBetweenCoords([this._user.lat,this._user.lng],[e.latlng.lat,e.latlng.lng])<o.NEW_MARKER_RANGE?this._newMarker=s.definePOI(e.latlng,this._markerSaved.bind(this)):console.log("New marker out of range"))}},{key:"_markerSaved",value:function(e){"spot"===e.type?this._marks.spot.push(e):"store"===e.type?this._marks.store.push(e):"bar"===e.type&&this._marks.bar.push(e),"false"===o.getPreference("poi-show-".concat(e.type))&&e.marker.removeFrom(this._map),this.updateMarkerCirclesVisibility(),this._newMarker=null}},{key:"updateMarkerCirclesVisibility",value:function(){var e=this,t=function(t){for(var r=0;r<t.length;++r)if(e._map.getBounds().contains(t[r].marker.getLatLng())){var n=t[r].marker,a=o.getDistanceBetweenCoords([e._user.lat,e._user.lng],[n.getLatLng().lat,n.getLatLng().lng]);a<o.CIRCLE_RADIUS&&!t[r].circle.visible?(t[r].circle.visible=!0,t[r].circle.setStyle({opacity:1,fillOpacity:.1})):a>=o.CIRCLE_RADIUS&&t[r].circle.visible&&(t[r].circle.visible=!1,t[r].circle.setStyle({opacity:0,fillOpacity:0}))}};"true"===o.getPreference("poi-show-circle")&&(t(this._marks.spot),t(this._marks.store),t(this._marks.bar),t([this._user]))}},{key:"map",get:function(){return this._map}},{key:"user",get:function(){return this._user}}])&&l(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.BeerCrackerz=t.default}();